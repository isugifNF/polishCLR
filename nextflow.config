/****************************
 * Default Parameter Values
 ****************************/

params {
  help = false
  monochrome_logs = false

  outdir = "PolishCLR_Results"

  /* Input files */
  primary_assembly = false
  alternate_assembly = false

  mitochondrial_assembly = false

  illumina_reads = false
  pacbio_reads = false
  k = "21"
  species = 'species_name'
  meryldb = false /* Passing in a prebuilt Illumina Meryl DB file will speed up QV checks */

  /* Modifiers */
  falcon_unzip = false
  same_specimen = true
  steptwo = false /* retire this */
  step = 1

  /* Slurm */
  queueSize = 12
  account = false
  threads = 40
  clusterOptions = false /* this will completely overwrite the above options */

  /* link executables (optional) */
  parallel_app = 'parallel'
  parallel_params = ' -j 2 '
  bzcat_app = 'bzcat'
  pigz_app = 'pigz'
  meryl_app = 'meryl'
  merqury_sh = '$MERQURY/merqury.sh'
  pbmm2_app = 'pbmm2'
  pbmm2_params = ' '
  minimap2_app = 'minimap2'
  minimap2_params = ' '
  samtools_app = 'samtools'
  gcpp_app = 'gcpp'
  gcpp_params = ' -x 10 -X 120 -q 0 '
  bwamem2_app = 'bwa-mem2'
  bwamem2_params = ' -SP '
  freebayes_app = 'freebayes'
  freebayes_params = ' --min-mapping-quality 0 --min-coverage 3 --min-supporting-allele-qsum 0  --ploidy 2 --min-alternate-fraction 0.2 --max-complex-gap 0 '
  bcftools_app = 'bcftools'
  merfin_app = 'merfin'
  merfin_params = ' '
  pbcstat_app = 'pbcstat'
  calcuts_app = 'calcuts'
  split_fa_app = 'split_fa'
  purge_dups_app = 'purge_dups'
  purge_dups_params = ' -2 -T p_cufoffs '
  get_seqs_app = 'get_seqs'
  gzip_app = 'gzip'
  busco_app = 'busco'
  busco_params = ' -l insecta_odb10 -m genome -f '

  /* hacky way of throwing an error on --profile, when it should be -profile */
  profile = false
  check_software = false
}

env {
  parallel_app = "$params.parallel_app"
  parallel_params = "$params.parallel_params"
  bzcat_app = "$params.bzcat_app"
  pigz_app = "$params.pigz_app"
  meryl_app = "$params.meryl_app"
  pbmm2_app = "$params.pbmm2_app"
  pbmm2_params = "$params.pbmm2_params"
  minimap2_app = "$params.minimap2_app"
  minimap2_params = "$params.minimap2_params"
  samtools_app = "$params.samtools_app"
  gcpp_app = "$params.gcpp_app"
  gcpp_params = "$params.gcpp_params"
  bwamem2_app = "$params.bwamem2_app"
  bwamem2_params = "$params.bwamem2_params"
  freebayes_app = "$params.freebayes_app"
  freebayes_params = "$params.freebayes_params"
  bcftools_app = "$params.bcftools_app"
  merfin_app = "$params.merfin_app"
  merfin_params = "$params.merfin_params"
  pbcstat_app = "$params.pbcstat_app"
  calcuts_app = "$params.calcuts_app"
  split_fa_app = "$params.split_fa_app"
  purge_dups_app = "$params.purge_dups_app"
  purge_dups_params = "$params.purge_dups_params"
  get_seqs_app = "$params.get_seqs_app"
  gzip_app = "$params.gzip_app"
  busco_app = "$params.busco_app"
  busco_params = "$params.busco_params"
}

process {
  publishDir = "$params.outdir"
}

profiles {
  standard {
    executor="local"
    includeConfig 'configs/publishdir.config'
  }
  slurm { 
    includeConfig 'configs/publishdir.config'
    includeConfig 'configs/slurm.config' 
  }
  ceres { 
    includeConfig 'configs/publishdir.config'
    includeConfig 'configs/ceres.config' 
  }
  atlas { 
    includeConfig 'configs/publishdir.config'
    includeConfig 'configs/atlas.config' 
  }
  sge { 
    includeConfig 'configs/publishdir.config'
    includeConfig 'configs/sge.config' 
  }
  singularity {
    includeConfig 'configs/publishdir.config'
    process.container = 'docker://csiva2022/polishclr:latest'
    singularity.enabled = true
    singularity.autoMounts = true
  }
  docker {
    includeConfig 'configs/publishdir.config'
    process.container = 'csiva2022/polishclr:latest'
    docker.enabled = true
    docker.runOptions = '-u \$(id -u):\$(id -g)'
  }
  local { 
    includeConfig 'configs/publishdir.config'
    executor="local"
  }
}

executor {
  queueSize = "$params.queueSize"
  submitRateLimit = '10 sec'
}

timeline {
  enabled = true
  file = "$params.outdir/timeline.html"
}

report {
  enabled = true
  file = "$params.outdir/report.html"
}

manifest {
  defaultBranch = 'main'
  name = 'isugifNF/polishCLR'
  homePage = 'https://github.com/isugifNF/polishCLR'
  description = 'Nextflow implementation of Arrow and FreeBayes assembly polishing'
  mainScript = 'main.nf'
  version = '1.0.0'
}
